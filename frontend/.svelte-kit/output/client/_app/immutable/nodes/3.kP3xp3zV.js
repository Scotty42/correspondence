import{f as u,a as d,c as Ke}from"../chunks/Dp-lm7Ug.js";import{o as qe}from"../chunks/BvysEO2T.js";import{A as Ie,B as C,C as we,G as t,D as Je,F as l,e as Ue,$ as Ve,I as s,K as r,J as e,M as W,L as ze,O as We}from"../chunks/1DOnEbbI.js";import{d as Ze,s as F,e as Qe}from"../chunks/DmiR870a.js";import{i as M}from"../chunks/CAGLYOiq.js";import{h as Re,c as Z,r as p,e as Xe,i as Ye}from"../chunks/BhBHE4xL.js";import{b as c}from"../chunks/B4BRPVhc.js";import{b as me}from"../chunks/GcPdi8XZ.js";var $e=u('<div class="alert alert-error"> </div>'),et=u('<div class="text-center mt-3"><span class="loading"></span></div>'),tt=u('<div class="form-group"><label class="form-label">Firmenname *</label> <input type="text" class="form-input" required/></div>'),at=u('<div class="card"><h2 class="mb-2 svelte-67057e"> </h2> <form><div class="form-group"><label class="form-label">Typ</label> <select class="form-select"><option>Firma</option><option>Person</option></select></div> <!> <div class="grid grid-2"><div class="form-group"><label class="form-label">Anrede</label> <select class="form-select"><option>-</option><option>Herr</option><option>Frau</option></select></div> <div class="form-group"><label class="form-label">Geschlecht</label> <select class="form-select"><option>-</option><option>Männlich</option><option>Weiblich</option><option>Divers</option></select></div></div> <div class="grid grid-2"><div class="form-group"><label class="form-label">Vorname</label> <input type="text" class="form-input"/></div> <div class="form-group"><label class="form-label">Nachname</label> <input type="text" class="form-input"/></div></div> <div class="form-group"><label class="form-label">Straße</label> <input type="text" class="form-input"/></div> <div class="grid grid-2"><div class="form-group"><label class="form-label">PLZ</label> <input type="text" class="form-input"/></div> <div class="form-group"><label class="form-label">Ort</label> <input type="text" class="form-input"/></div></div> <div class="grid grid-2"><div class="form-group"><label class="form-label">E-Mail</label> <input type="email" class="form-input"/></div> <div class="form-group"><label class="form-label">Telefon</label> <input type="text" class="form-input"/></div></div> <div class="form-group"><label class="form-label">Kundennummer</label> <input type="text" class="form-input"/></div> <div class="form-group"><label class="form-label">Notizen</label> <textarea class="form-textarea"></textarea></div> <div class="flex gap-1 mt-2"><button type="submit" class="btn btn-primary">Speichern</button> <button type="button" class="btn btn-secondary">Abbrechen</button></div></form></div>'),rt=u('<div class="card text-center"><p class="text-muted">Noch keine Kontakte vorhanden.</p> <button class="btn btn-primary mt-2">Ersten Kontakt anlegen</button></div>'),st=u('<div class="text-muted"> </div>'),ot=u('<tr><td><strong> </strong> <!></td><td> </td><td> </td><td> </td><td class="text-right"><button class="btn btn-secondary btn-sm">Bearbeiten</button> <button class="btn btn-danger btn-sm">Löschen</button></td></tr>'),it=u('<div class="card"><table class="table"><thead><tr><th>Name</th><th>Ort</th><th>E-Mail</th><th>Telefon</th><th></th></tr></thead><tbody></tbody></table></div>'),lt=u('<div class="contacts-page"><div class="flex-between mb-3"><h1 class="svelte-67057e">Kontakte</h1> <button class="btn btn-primary">+ Neuer Kontakt</button></div> <!> <!></div>');function ft(Ne,Ee){Ie(Ee,!0);let Q=C(we([])),R=C(!0),D=C(""),A=C(!1),B=C(null),o=C(we({contact_type:"company",company_name:"",salutation:"",first_name:"",last_name:"",gender:"",street:"",zip_code:"",city:"",email:"",phone:"",customer_number:"",notes:""}));qe(X);async function X(){l(R,!0);try{l(Q,await Z.list(),!0)}catch(a){l(D,a instanceof Error?a.message:"Fehler beim Laden",!0)}finally{l(R,!1)}}function Y(){l(o,{contact_type:"company",company_name:"",salutation:"",first_name:"",last_name:"",gender:"",street:"",zip_code:"",city:"",email:"",phone:"",customer_number:"",notes:""},!0),l(B,null)}function de(){Y(),l(A,!0)}function Le(a){l(B,a,!0),l(o,{contact_type:a.contact_type,company_name:a.company_name||"",salutation:a.salutation||"",first_name:a.first_name||"",last_name:a.last_name||"",gender:a.gender||"",street:a.street||"",zip_code:a.zip_code||"",city:a.city||"",email:a.email||"",phone:a.phone||"",customer_number:a.customer_number||"",notes:a.notes||""},!0),l(A,!0)}async function Ce(){try{e(B)?await Z.update(e(B).id,e(o)):await Z.create(e(o)),l(A,!1),Y(),await X()}catch(a){l(D,a instanceof Error?a.message:"Fehler beim Speichern",!0)}}async function Me(a){if(confirm("Kontakt wirklich löschen?"))try{await Z.delete(a),await X()}catch(v){l(D,v instanceof Error?v.message:"Fehler beim Löschen",!0)}}function De(a){return a.company_name?a.company_name:[a.first_name,a.last_name].filter(Boolean).join(" ")||"Unbenannt"}var $=lt();Re("67057e",a=>{Ue(()=>{Ve.title="Kontakte - Korrespondenz"})});var ee=s($),Ae=t(s(ee),2);Ae.__click=de,r(ee);var _e=t(ee,2);{var Be=a=>{var v=$e(),te=s(v,!0);r(v),W(()=>F(te,e(D))),d(a,v)};M(_e,a=>{e(D)&&a(Be)})}var Oe=t(_e,2);{var Se=a=>{var v=et();d(a,v)},Te=a=>{var v=Ke(),te=ze(v);{var Ge=K=>{var w=at(),O=s(w),ae=s(O,!0);r(O);var S=t(O,2),_=s(S),m=t(s(_),2),f=s(m);f.value=f.__value="company";var T=t(f);T.value=T.__value="person",r(m),r(_);var I=t(_,2);{var n=i=>{var ve=tt(),Fe=t(s(ve),2);p(Fe),r(ve),c(Fe,()=>e(o).company_name,je=>e(o).company_name=je),d(i,ve)};M(I,i=>{e(o).contact_type==="company"&&i(n)})}var y=t(I,2),h=s(y),g=t(s(h),2),G=s(g);G.value=G.__value="";var H=t(G);H.value=H.__value="Herr";var J=t(H);J.value=J.__value="Frau",r(g),r(h);var z=t(h,2),P=t(s(z),2),x=s(P);x.value=x.__value="";var j=t(x);j.value=j.__value="m";var k=t(j);k.value=k.__value="f";var U=t(k);U.value=U.__value="d",r(P),r(z),r(y);var N=t(y,2),E=s(N),V=t(s(E),2);p(V),r(E);var b=t(E,2),L=t(s(b),2);p(L),r(b),r(N);var q=t(N,2),ce=t(s(q),2);p(ce),r(q);var re=t(q,2),se=s(re),pe=t(s(se),2);p(pe),r(se);var ue=t(se,2),fe=t(s(ue),2);p(fe),r(ue),r(re);var oe=t(re,2),ie=s(oe),be=t(s(ie),2);p(be),r(ie);var ye=t(ie,2),he=t(s(ye),2);p(he),r(ye),r(oe);var le=t(oe,2),ge=t(s(le),2);p(ge),r(le);var ne=t(le,2),xe=t(s(ne),2);We(xe),r(ne);var ke=t(ne,2),Pe=t(s(ke),2);Pe.__click=()=>{l(A,!1),Y()},r(ke),r(S),r(w),W(()=>F(ae,e(B)?"Kontakt bearbeiten":"Neuer Kontakt")),Qe("submit",S,i=>{i.preventDefault(),Ce()}),me(m,()=>e(o).contact_type,i=>e(o).contact_type=i),me(g,()=>e(o).salutation,i=>e(o).salutation=i),me(P,()=>e(o).gender,i=>e(o).gender=i),c(V,()=>e(o).first_name,i=>e(o).first_name=i),c(L,()=>e(o).last_name,i=>e(o).last_name=i),c(ce,()=>e(o).street,i=>e(o).street=i),c(pe,()=>e(o).zip_code,i=>e(o).zip_code=i),c(fe,()=>e(o).city,i=>e(o).city=i),c(be,()=>e(o).email,i=>e(o).email=i),c(he,()=>e(o).phone,i=>e(o).phone=i),c(ge,()=>e(o).customer_number,i=>e(o).customer_number=i),c(xe,()=>e(o).notes,i=>e(o).notes=i),d(K,w)},He=K=>{var w=Ke(),O=ze(w);{var ae=_=>{var m=rt(),f=t(s(m),2);f.__click=de,r(m),d(_,m)},S=_=>{var m=it(),f=s(m),T=t(s(f));Xe(T,21,()=>e(Q),Ye,(I,n)=>{var y=ot(),h=s(y),g=s(h),G=s(g,!0);r(g);var H=t(g,2);{var J=b=>{var L=st(),q=s(L);r(L),W(()=>F(q,`${e(n).first_name??""} ${e(n).last_name??""}`)),d(b,L)};M(H,b=>{e(n).contact_type==="company"&&e(n).first_name&&b(J)})}r(h);var z=t(h),P=s(z,!0);r(z);var x=t(z),j=s(x,!0);r(x);var k=t(x),U=s(k,!0);r(k);var N=t(k),E=s(N);E.__click=()=>Le(e(n));var V=t(E,2);V.__click=()=>Me(e(n).id),r(N),r(y),W(b=>{F(G,b),F(P,e(n).city||"-"),F(j,e(n).email||"-"),F(U,e(n).phone||"-")},[()=>De(e(n))]),d(I,y)}),r(T),r(f),r(m),d(_,m)};M(O,_=>{e(Q).length===0?_(ae):_(S,!1)},!0)}d(K,w)};M(te,K=>{e(A)?K(Ge):K(He,!1)},!0)}d(a,v)};M(Oe,a=>{e(R)?a(Se):a(Te,!1)})}r($),d(Ne,$),Je()}Ze(["click"]);export{ft as component};
