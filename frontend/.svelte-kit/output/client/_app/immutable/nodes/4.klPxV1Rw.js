import{f as v,a as l,c as Dt}from"../chunks/Dp-lm7Ug.js";import{o as kt}from"../chunks/BvysEO2T.js";import{A as wt,B as g,C as At,I as a,G as n,J as r,D as Ft,e as Lt,F as d,$ as Bt,K as e,M as P,L as Et}from"../chunks/1DOnEbbI.js";import{d as Rt,s as u}from"../chunks/DmiR870a.js";import{i as h}from"../chunks/CAGLYOiq.js";import{h as Kt,d as y,e as Tt,s as jt,i as Ct}from"../chunks/BhBHE4xL.js";import{b as It}from"../chunks/GcPdi8XZ.js";var Mt=v('<div class="alert alert-error"> </div>'),Nt=v('<div class="text-center mt-3"><span class="loading"></span></div>'),Pt=v('<div class="card text-center"><p class="text-muted">Keine Dokumente gefunden.</p></div>'),St=v('<span class="badge badge-success">Archiviert</span>'),Ut=v('<span class="badge badge-secondary"> </span>'),zt=v('<button class="btn btn-success btn-sm">Archivieren</button>'),Gt=v('<tr><td><strong> </strong></td><td><span class="badge badge-primary"> </span></td><td> </td><td> </td><td> </td><td><!></td><td class="text-right"><div class="flex gap-1" style="justify-content: flex-end;"><a target="_blank" class="btn btn-secondary btn-sm">PDF</a> <!> <button class="btn btn-danger btn-sm">Löschen</button></div></td></tr>'),Jt=v('<div class="card"><table class="table"><thead><tr><th>Nummer</th><th>Typ</th><th>Betreff</th><th>Datum</th><th>Betrag</th><th>Status</th><th></th></tr></thead><tbody></tbody></table></div>'),qt=v('<div class="documents-page"><div class="flex-between mb-3"><h1 class="svelte-220hbx">Dokumente</h1> <div class="flex gap-1"><a href="/documents/letter" class="btn btn-primary">+ Brief</a> <a href="/documents/invoice" class="btn btn-primary">+ Rechnung</a> <a href="/documents/offer" class="btn btn-primary">+ Angebot</a></div></div> <!> <div class="card mb-2"><div class="flex gap-1"><select class="form-select" style="width: auto;"><option>Alle Typen</option><option>Briefe</option><option>Rechnungen</option><option>Angebote</option></select></div></div> <!></div>');function Zt(X,Y){wt(Y,!0);let x=g(At([])),D=g(!0),_=g(""),k=g("");kt(b);async function b(){d(D,!0);try{d(x,await y.list(r(k)||void 0),!0)}catch(t){d(_,t instanceof Error?t.message:"Fehler beim Laden",!0)}finally{d(D,!1)}}function Z(t){return new Date(t).toLocaleDateString("de-DE")}function $(t){return t===null?"-":new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(t)}function tt(t){return{letter:"Brief",invoice:"Rechnung",offer:"Angebot"}[t]||t}async function et(t){if(t.status!=="archived")try{await y.archive(t.id),await b()}catch(s){d(_,s instanceof Error?s.message:"Fehler beim Archivieren",!0)}}async function at(t){if(confirm("Dokument wirklich löschen?"))try{await y.delete(t),await b()}catch(s){d(_,s instanceof Error?s.message:"Fehler beim Löschen",!0)}}function rt(){b()}var w=qt();Kt("220hbx",t=>{Lt(()=>{Bt.title="Dokumente - Korrespondenz"})});var S=n(a(w),2);{var st=t=>{var s=Mt(),E=a(s,!0);e(s),P(()=>u(E,r(_))),l(t,s)};h(S,t=>{r(_)&&t(st)})}var A=n(S,2),U=a(A),p=a(U);p.__change=rt;var F=a(p);F.value=F.__value="";var L=n(F);L.value=L.__value="letter";var B=n(L);B.value=B.__value="invoice";var z=n(B);z.value=z.__value="offer",e(p),e(U),e(A);var nt=n(A,2);{var ot=t=>{var s=Nt();l(t,s)},it=t=>{var s=Dt(),E=Et(s);{var ct=f=>{var m=Pt();l(f,m)},lt=f=>{var m=Jt(),G=a(m),J=n(a(G));Tt(J,21,()=>r(x),Ct,(vt,i)=>{var R=Gt(),K=a(R),q=a(K),dt=a(q,!0);e(q),e(K);var T=n(K),H=a(T),ut=a(H,!0);e(H),e(T);var j=n(T),ft=a(j,!0);e(j);var C=n(j),_t=a(C,!0);e(C);var I=n(C),mt=a(I,!0);e(I);var M=n(I),ht=a(M);{var bt=o=>{var c=St();l(o,c)},pt=o=>{var c=Ut(),N=a(c,!0);e(c),P(()=>u(N,r(i).status)),l(o,c)};h(ht,o=>{r(i).status==="archived"?o(bt):o(pt,!1)})}e(M);var O=n(M),Q=a(O),V=a(Q),W=n(V,2);{var gt=o=>{var c=zt();c.__click=()=>et(r(i)),l(o,c)};h(W,o=>{r(i).status!=="archived"&&o(gt)})}var yt=n(W,2);yt.__click=()=>at(r(i).id),e(Q),e(O),e(R),P((o,c,N,xt)=>{u(dt,r(i).doc_number),u(ut,o),u(ft,r(i).subject||"-"),u(_t,c),u(mt,N),jt(V,"href",xt)},[()=>tt(r(i).doc_type),()=>Z(r(i).doc_date),()=>$(r(i).gross_total),()=>y.getPdfUrl(r(i).id)]),l(vt,R)}),e(J),e(G),e(m),l(f,m)};h(E,f=>{r(x).length===0?f(ct):f(lt,!1)},!0)}l(t,s)};h(nt,t=>{r(D)?t(ot):t(it,!1)})}e(w),It(p,()=>r(k),t=>d(k,t)),l(X,w),Ft()}Rt(["change","click"]);export{Zt as component};
